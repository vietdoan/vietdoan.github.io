<!DOCTYPE html>
<html lang="zh-cmn-Hans">
   <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1" />
  <meta name="author" content="Vido">
  <meta name="description" content="Clustered Index lÃ  gÃ¬ vÃ  táº¡i sao nÃ³ cÃ³ thá»ƒ tÄƒng tá»‘c Ä‘á»™ Ä‘á»c báº£n ghi trong cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡.">
  
  <meta property="og:title" content="Clustered Index" />
<meta property="og:description" content="Clustered Index lÃ  gÃ¬ vÃ  táº¡i sao nÃ³ cÃ³ thá»ƒ tÄƒng tá»‘c Ä‘á»™ Ä‘á»c báº£n ghi trong cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://imvido.com/blog/2019-09/clustered-index/" />
<meta property="article:published_time" content="2019-09-08T14:08:32+07:00" />
<meta property="article:modified_time" content="2019-09-08T14:08:32+07:00" />


  <title>
  
       Clustered Index | Vido Blog 
  
  </title>

  <link rel="canonical" href="https://imvido.com/blog/2019-09/clustered-index/">

  
  

  
  <link href="https://imvido.com/css/vendors-extensions/fontawesome/all.min.css" rel="stylesheet">

  
  <link href="https://imvido.com/css/font.css" rel="stylesheet"> 
    
  
  <link href="https://imvido.com/css/vendors/bootstrap4/bootstrap.min.css" rel="stylesheet">
  <link href="https://imvido.com/css/vendors-extensions/mdb/mdb.min.css" rel="stylesheet"> 
  <link href="https://imvido.com/css/vendors/mdb/style.min.css" rel="stylesheet"> 
  <link href="https://imvido.com/style/main.css" rel="stylesheet">

  
  <link rel="shortcut icon"
  
      href="https://res.cloudinary.com/vido/image/upload/v1567358559/images/profile_kpasju.jpg"
  
  >


  
  

  <style type="text/css">
      @media (min-width: 800px) and (max-width: 850px) {
              .navbar:not(.top-nav-collapse) {
                  background: #1C2331!important;
              }
          }
  </style>


  
    
    <link rel="stylesheet" href="https://imvido.com/js/vendors/katex/katex.min.css">
  
  

  
    
    <link rel="stylesheet" href="https://imvido.com/css/vendors/highlight/github-gist.css">
  

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open&#43;Sans:400,700%7cUbuntu&#43;Mono:400,400i,700,700i%7cRaleway:300,400,500,600">
</head>

  <body class="bg-light" data-spy="scroll" data-target="#page-scrollspy" data-offset="90">
  
    
    

    
      


<nav class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar">
    <div class="container">

      
      <a class="navbar-brand" href="https://imvido.com">
          
        <img class="avatar" src="https://imvido.com" style="width: 40px!important;height: auto;"  class="d-inline-block align-top" alt="" >
        
        <strong> Vido</strong>
      </a>

      
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      
      <div class="collapse navbar-collapse" id="navbarSupportedContent">

        
        <ul class="navbar-nav mr-auto ">
          <li class="nav-item ">
            <a class="nav-link" href="https://imvido.com">Home</a>
          </li>
             
            <li class="nav-item ">
              <a class="nav-link" href="https://imvido.com/blog/" >Blog  </a>
            </li>
          
             
            <li class="nav-item ">
              <a class="nav-link" href="https://imvido.com/moment/" >Moment  </a>
            </li>
          
             
            <li class="nav-item ">
              <a class="nav-link" href="https://imvido.com/about/" >About  </a>
            </li>
          
          
        </ul>

      </div>

    </div>
  </nav>
  
 
      
 






<div id="site-header" class="carousel slide carousel-fade" data-ride="carousel" style="height: 18rem;" >  

  
  
  

  
  <div class="carousel-inner" role="listbox">
    
      

        
        <div class="carousel-item active">
          <div class="view" style="background-image: url('https://imvido.com/header-slides/markus-spiske-QJssnBZfqmQ-unsplash.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

              
              
              

            </div>
            

          </div>
        </div>
        
      
    
      

        
        <div class="carousel-item">
          <div class="view" style="background-image: url('https://imvido.com/header-slides//max-nelson-Y9w872CNIyI-unsplash.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

            

            </div>
            

          </div>
        </div>
        
      
    

  
  </div>
  

  
  <div class="carousel-content text-center white-text wow fadeIn">
    <div class="row mx-0 headfont mt-3 pt-4">
      
      <div class="col-12 col-sm-5 align-middle">
        <a href="https://imvido.com">
          
            <img class="pull-right avatar avatar-md" src="https://res.cloudinary.com/vido/image/upload/v1567358559/images/profile_kpasju.jpg" alt="" >
          
        </a>
      </div>
      
      <div class="col-12 col-sm-7 text-left pl-2">
        <a href="https://imvido.com">
          <h1 class="mb-2 h1" style="font-weight: 300;" >
            <strong>Vido Blog</strong>
          </h1>
        </a>
        

             
        <div class="mt-2" style="font-size: 1rem; color: white;">
            
              <a href="//github.com/vietdoan" target="_blank" rel="noopener"><i class="fab fa-github pr-1" aria-hidden="true"></i></a>    
            
            
              <a href="//linkedin.com/in/van-viet-doan-171017b5/" target="_blank" rel="noopener"><i class="fab fa-linkedin pr-1" aria-hidden="true"></i></a>
            

            
              <a href="//facebook.com/vietdoan.hp" target="_blank" rel="noopener"><i class="fab fa-facebook pr-1" aria-hidden="true"></i></a>
            

            

            

            
    
            
    
        
            
                <a href="mailto:vietdoanhp1996@email.com"><i class="far fa-envelope-open pr-1" aria-hidden="true"></i></a>
            
    
            

            
        </div>
      </div>
    </div>
  </div>
  

  
  
  

</div>
  
    

    
  
  <main class="post-main-wrapper">
    
    
    <div class="row">

      

      
      <div class="container pr-5">
      

        
        <div class="z-depth-1  post-wrapper white-bg single-post">

          <div class="post-header text-center" >
  <ul class="post-meta li-x">
    
    
  </ul>

  <div class="px-4 post-heading">Clustered Index</div>

  <ul class="post-meta li-x mt-1">
    
      <li>Sep 8, 2019</li>
    

    
      <li class="middot"></li>
      <li>8 minutes read</li>
    
  </ul>
  

</div>


          <div class="post-content markdown">
            

<h2 id="nhá»¯ng-Ä‘iá»u-cáº§n-biáº¿t">Nhá»¯ng Ä‘iá»u cáº§n biáº¿t</h2>

<p>Náº¿u báº¡n cÃ³ má»™t chÃºt kinh nghiá»‡m vá» láº­p trÃ¬nh, hiá»ƒu Ä‘Æ°á»£c má»™t sá»‘ khÃ¡i niá»‡m cÆ¡ báº£n cá»§a cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ (relational database) vÃ  SQL (nhÆ° lÃ  index, primary key) thÃ¬ sáº½ dá»… Ä‘á»c hÆ¡n.</p>

<h2 id="giá»›i-thiá»‡u">Giá»›i thiá»‡u</h2>

<p>Trong bÃ i viáº¿t nÃ y tÃ´i sáº½ trÃ¬nh bÃ y hiá»ƒu biáº¿t cá»§a báº£n thÃ¢n vá» clustered index vÃ  táº¡i sao nÃ³ cÃ³ thá»ƒ giÃºp báº¡n cáº£i thiá»‡n Ä‘Æ°á»£c tá»‘c Ä‘á»™ truy váº¥n dá»¯ liá»‡u khi  sá»­ dá»¥ng cÃ¡c  há»‡ thá»‘ng  quáº£n lÃ½ cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡  (Relational database  management system). BÃ i viáº¿t bao gá»“m:</p>

<ul>
<li>Ã tÆ°á»Ÿng chung cá»§a clustered index vÃ  secondary index.</li>
<li>Clustered Index trong MySQL.</li>
</ul>

<h2 id="clustered-index">Clustered Index</h2>

<h3 id="b-tree">B-Tree</h3>

<p>Index lÃ  má»™t pháº§n tá»‘i quan trá»ng cá»§a má»™t cÆ¡ sá»Ÿ dá»¯ liá»‡u vÃ¬ nÃ³ giÃºp tÄƒng tá»‘c viá»‡c truy váº¥n thÃ´ng tin. Äá»ƒ duy trÃ¬ index cá»§a má»™t báº£ng, ngÆ°á»i ta thÆ°á»ng sá»­ dá»¥ng cÃ¡c cáº¥u trÃºc dá»¯ liá»‡u nhÆ° hash, B-Tree, LSM-Tree,&hellip; NhÆ°ng khi ai Ä‘Ã³ nÃ³i vá»›i báº¡n lÃ  báº£ng cá»§a há» cÃ³ sá»­ dá»¥ng clustered index thÃ¬ nhiá»u kháº£ nÄƒng cáº¥u trÃºc dá»¯ liá»‡u há» Ä‘ang sá»­ dá»¥ng Ä‘á»ƒ lÆ°u index cho báº£ng lÃ  B-Tree. CÃ³ thá»ƒ hiá»ƒu B-tree lÃ  má»™t cáº¥u trÃºc dá»¯ liá»‡u dáº¡ng cÃ¢y mÃ  nÃºt lÃ¡ sáº½ lÆ°u thÃ´ng tin vá» má»™t báº£n ghi trong báº£ng (row / record) vÃ  cÃ¡c nÃºt cÃ²n láº¡i (internal node) sáº½ lÆ°u cÃ¡c index key vÃ  cÃ¡c con trá» Ä‘áº¿n nÃºt con cá»§a nÃ³. B-Tree Ä‘Ã¡nh Ä‘á»•i khÃ´ng gian dá»¯ liá»‡u (má»™t thá»© ráº¥t ráº» á»Ÿ thá»i Ä‘iá»ƒm hiá»‡n táº¡i) vÃ  Ä‘á»™ phá»©c táº¡p cá»§a viá»‡c ghi Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ Ä‘á»c.
<img src="https://res.cloudinary.com/vido/image/upload/v1567940701/images/clustered-index/Screenshot_from_2019-09-08_15-14-52_b2vt52.png" alt="" />
VÃ­ dá»¥ vá» má»™t báº£ng lÆ°u thÃ´ng tin cá»§a user, dÃ¹ng B-Tree Ä‘á»ƒ Ä‘Ã¡nh index trÃªn cá»™t <code>user_id</code>. HÃ¬nh trÃªn  mÃ´ táº£ cÃ¡ch storage engine tÃ¬m Ä‘Æ°á»£c báº£n ghi chá»©a thÃ´ng tin cá»§a user vá»›i <code>user_id</code> lÃ  <code>251</code>.  CÃ³ thá»ƒ tháº¥y lÃ  má»—i internal node lÆ°u thÃ´ng tin vá» cÃ¡c khoáº£ng <code>user_id</code> vÃ  á»Ÿ má»—i node viá»‡c cá»§a storage engine lÃ  tÃ¬m xem khoáº£ng nÃ o chá»©a giÃ¡ trá»‹ <code>user_id</code> truy váº¥n vÃ  cá»© tháº¿ tÃ¬m ra &ldquo;Ä‘Æ°á»ng Ä‘i&rdquo; Ä‘áº¿n nÃºt lÃ¡. NÃºt lÃ¡ sáº½ chá»©a key mÃ  báº¡n Ä‘ang tÃ¬m (Ä‘Æ°Æ¡ng nhiÃªn rá»“i) vÃ  tham chiáº¿u (reference) Ä‘áº¿n nÆ¡i lÆ°u báº£n ghi hoáº·c chÃ­nh báº£n ghi.</p>

<p>Má»™t Ä‘iá»u mÃ  báº¡n cáº§n lÆ°u Ã½ lÃ  cÃ¡c node trong key náº±m gá»n trong 1 page . CÃ³ thá»ƒ hiá»ƒu Ä‘Æ¡n giáº£n page lÃ  Ä‘Æ¡n vá»‹ bÃ© nháº¥t Ä‘á»ƒ lÆ°u trá»¯ data trong bá»™ nhá»› vÃ  Ä‘á»c dá»¯ liá»‡u tá»« 1 page lÃ  nhanh nháº¥t. TÆ°á»Ÿng tÆ°á»£ng page lÃ  1 trang sÃ¡ch (get it ğŸ˜†), data mÃ  báº¡n cáº§n tÃ¬m lÃ  Ä‘oáº¡n vÄƒn náº±m trong trang sÃ¡ch Ä‘Ã³ vÃ  2 Ä‘oáº¡n vÄƒn trÃªn vÃ  dÆ°á»›i cÃ³ thá»ƒ nÃ³i vá» 2 váº¥n Ä‘á» hoÃ n toÃ n khÃ¡c nhau, tháº­m chÃ­ cÃ¡c Ä‘oáº¡n vÄƒn liÃªn quan Ä‘áº¿n nhau cÃ²n náº±m khÃ´ng theo thá»© tá»± vÃ  ráº£i rÃ¡c á»Ÿ ráº¥t nhiá»u trang (tháº¿ giá»›i OS nÃ³ lÃ  váº­y Ä‘Ã³, cháº¥p nháº­n Ä‘i). Thá»i gian báº¡n Ä‘á»c háº¿t ná»™i dung trong trang Ä‘Ã³ sáº½ ngáº¯n hÆ¡n lÃ  thá»i gian báº¡n Ä‘i tÃ¬m má»™t trang nÃ o Ä‘Ã³ trong má»¥c lá»¥c rá»“i láº§n mÃ² Ä‘áº¿n trang Ä‘Ã³ vÃ  Ä‘á»c. Báº±ng cÃ¡ch lÆ°u háº¿t thÃ´ng tin trong 1 page, viá»‡c tÃ¬m kiáº¿m trong B-Tree trá»Ÿ lÃªn nhanh hÆ¡n ráº¥t nhiá»u.</p>

<p>HÃ nh trÃ¬nh tÃ¬m dá»¯ liá»‡u cá»§a báº¡n thá»±c ra lÃ  nháº£y tá»« page nÃ y sang page khÃ¡c, á»Ÿ má»—i page chá»‰ cáº§n báº¡n biáº¿t Ä‘á»‹a chá»‰ lÃ  gÃ¬ (<code>user_id</code>) thÃ¬ báº¡n sáº½ biáº¿t pháº£i Ä‘i theo Ä‘Æ°á»ng nÃ o (reference).</p>

<p>Äá»™ phá»©c táº¡p cá»§a B-Tree lÃ  O(log N) cho ghi vÃ  Ä‘á»c. Tá»“n táº¡i qua gáº§n ná»­a tháº¿ ká»‰, nÃ³ váº«n Ä‘ang lÃ  cáº¥u trÃºc dá»¯ liá»‡u phá»• biáº¿n nháº¥t dÃ¹ng cho cáº£ cÆ¡ sá»Ÿ dá»¯ liá»‡u quan há»‡ vÃ  phi quan há»‡.</p>

<h3 id="clustered-index-1">Clustered Index</h3>

<p>NhÆ° Ä‘Ã£ nÃ³i thÃ¬ nÃºt lÃ¡ cÃ³ thá»ƒ lÆ°u tham chiáº¿u Ä‘áº¿n nÆ¡i lÆ°u trá»¯ báº£n ghi (gá»i lÃ  heap file) hoáº·c lÃ  lÆ°u luÃ´n báº£n ghi. Cáº£ 2 phÆ°Æ¡ng phÃ¡p Ä‘á»u cÃ³ máº·t lá»£i vÃ  háº¡i, náº¿u phÆ°Æ¡ng phÃ¡p thá»© nháº¥t trÃ¡nh viá»‡c data bá»‹ láº·p láº¡i (duplicate) á»Ÿ nhiá»u nÆ¡i trong disk qua Ä‘Ã³ tÃ­ch kiá»‡m khÃ´ng gian lÆ°u trá»¯ thÃ¬ phÆ°Æ¡ng phÃ¡p thá»© 2 sáº½ tÄƒng tá»‘c Ä‘á»™ Ä‘á»c (nhÆ° tÃ´i Ä‘Ã£ nÃ³i thÃ¬ viá»‡c Ä‘á»c thÃ´ng tin trong 1 page lÃ  nhanh nháº¥t vÃ  thá»i gian tÃ¬m Ä‘Ãºng page Ä‘á»ƒ Ä‘á»c lÃ  ráº¥t dÃ i).
Náº¿u storage engine cá»§a há»‡ thá»‘ng cÆ¡ sá»Ÿ dá»¯ liá»‡u báº¡n Ä‘ang dÃ¹ng chá»n phÆ°Æ¡ng phÃ¡p thá»© 2 cho B-Tree thÃ¬ Ä‘Ã³ lÃ  <strong>clustered index</strong>. Viá»‡c lÆ°u luÃ´n báº£n ghi cÃ¹ng vá»›i key khiáº¿n cÃ¡c báº£n ghi cÃ³ key gáº§n nhau thÆ°á»ng Ä‘Æ°á»£c lÆ°u gáº§n nhau (gáº§n á»Ÿ Ä‘Ã¢y lÃ  trong cÃ¹ng 1 page luÃ´n), Ä‘Ã³ lÃ  lÃ­ do cÃ³ tá»« clustered. Má»¥c Ä‘Ã­ch lÃ  Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ tÃ¬m vÃ  Ä‘á»c báº£n ghi.</p>

<p>Má»—i má»™t báº£ng sáº½ chá»‰ cÃ³ má»™t clustered index vÃ¬ náº¿u khÃ´ng má»—i láº§n update má»™t báº£n ghi, storage engine sáº½ pháº£i tÃ¬m vÃ  update á»Ÿ nhiá»u nÆ¡i khÃ¡c nhau. Váº­y nÃªn cÃ¡c index khÃ¡c sáº½ khÃ´ng lÆ°u báº£n ghi á»Ÿ nÃºt lÃ¡ mÃ  thay vÃ¬ Ä‘Ã³ sáº½ lÆ°u tham chiáº¿u tá»›i báº£n ghi hoáº·c lÃ  lÆ°u giÃ¡ trá»‹ cá»§a column Ä‘Æ°á»£c Ä‘Ã¡nh clustered index. Má»™t láº§n ná»¯a, quyáº¿t Ä‘á»‹nh chá»n giáº£i phÃ¡p nÃ o lÃ  tÃ¹y thuá»™c vÃ o tá»«ng storage engine, nhÆ°ng ta Ä‘á»u gá»i chung cÃ¡c index Ä‘Ã³ lÃ  <strong>secondary index</strong>.
<img src="https://res.cloudinary.com/vido/image/upload/v1567941148/images/clustered-index/Screenshot_from_2019-09-08_18-11-50_qniblb.png" alt="" /></p>

<p>Khi sá»­ dá»¥ng clustered index thÃ¬ khÃ´ng nÃªn xÃ©t giÃ¡ trá»‹ cá»§a cá»™t tÆ°Æ¡ng á»©ng lÃ  cÃ¡c giÃ¡ trá»‹ random (nhÆ° UUID cháº³ng háº¡n) vÃ¬ nÃ³ sáº½ áº£nh hÆ°á»Ÿng ráº¥t nhiá»u Ä‘áº¿n tá»‘c Ä‘á»™ ghi, thay vÃ o Ä‘Ã³ nÃªn set attribute AUTO_INCREMENT cho cá»™t Ä‘Ã³. LÃ­ do lÃ  vÃ¬ khi báº¡n insert báº£n ghi tuáº§n tá»± tá»« trÃ¡i sang pháº£i (do key cÃ³ giÃ¡ trá»‹ tÄƒng dáº§n) cÃ¡c báº£n ghi vÃ  key Ä‘Æ°á»£c ghi vÃ o tá»«ng page, Ä‘áº§y page nÃ y thÃ¬ sang page khÃ¡c nhÆ° hÃ¬nh dÆ°á»›i
<img src="https://res.cloudinary.com/vido/image/upload/v1567953475/images/clustered-index/Screenshot_from_2019-09-08_21-37-18_mj5cxc.png" alt="" />
CÃ²n náº¿u giÃ¡ trá»‹ key Ä‘Ã³ lÃ  ngáº«u nhiÃªn, thÃ¬ khi thÃªm má»™t báº£n ghi cÃ³ thá»ƒ báº¡n sáº½ pháº£i ghi nÃ³ vÃ o má»™t page vá»‘n Ä‘Ã£ Ä‘áº§y. LÃºc nÃ y storage engine pháº£i tÃ¡ch page cÅ©, kiáº¿m má»™t page má»›i vÃ  copy ná»­a bÃªn pháº£i sang page má»›i rá»“i má»›i ghi báº£n ghi má»›i vÃ o page cÅ©. Nhá»¯ng thao tÃ¡c Ä‘Ã³ tá»‘n ráº¥t nhiá»u thao tÃ¡c I/O. KhÃ´ng nhá»¯ng tá»‘n thá»i gian, nÃ³ cÃ²n dáº«n Ä‘áº¿n tÃ¬nh tráº¡ng phÃ¢n máº£nh ná»™i (internal fragmentation), nhá»› vá» vÃ­ dá»¥ trang giáº¥y á»Ÿ trÃªn, giá»‘ng nhÆ° lÃ  khÃ´ng viáº¿t háº¿t táº¥t cáº£ cÃ¡c dÃ²ng cá»§a trang sÃ¡ch, má»—i trang chá»‰ ghi Ä‘Æ°á»£c má»™t sá»‘ dÃ²ng rá»“i Ä‘á»ƒ thá»«a dáº«n Ä‘áº¿n &hellip; lÃ£ng phÃ­. KÃ­ch thÆ°á»›c cá»§a cÃ¢y index sáº½ phÃ¬nh ra (giá»‘ng nhÆ° lÃ  quyá»ƒn sÃ¡ch bá»‹ Ä‘á»™n dÃ y thÃªm).</p>

<p>DÆ°á»›i Ä‘Ã¢y lÃ  benchmark khi chÃ¨n thÃªm báº£n ghi vÃ o báº£ng (dÃ¹ng InnoDB cá»§a MySQL) khi xÃ i key tÄƒng dáº§n vÃ  UUID. CÃ³ thá»ƒ tháº¥y rÃµ lÃ  báº£ng cÃ ng nhiá»u báº£n ghi thÃ¬ thá»i gian ghi má»›i cÃ ng lÃ¢u vÃ  kÃ­ch thÆ°á»›c cÃ¢y cÃ ng lá»›n.
<img src="https://res.cloudinary.com/vido/image/upload/v1567954291/images/clustered-index/Screenshot_from_2019-09-08_21-51-07_bhdnmy.png" alt="" /></p>

<h3 id="clustered-index-trong-mysql">Clustered Index trong MySQL</h3>

<p>Vá»›i MySQL, báº¡n cáº§n dÃ¹ng storage engine InnoDB Ä‘á»ƒ cÃ³ thá»ƒ dÃ¹ng clustered index. InnoDB sáº½ Ä‘Ã¡nh clustered index trÃªn primary key vÃ  trong trÆ°á»ng há»£p báº¡n khÃ´ng define primary key thÃ¬ nÃ³ sáº½ thá»­ sá»­ dá»¥ng má»™t unique nonnullable key. Náº¿u váº«n khÃ´ng tÃ¬m Ä‘Æ°á»£c thÃ¬ nÃ³ sáº½ tiáº¿p tá»¥c khai bÃ¡o má»™t primary key áº©n (chÃ­nh lÃ  ID) vÃ  Ä‘Ã¡nh clustered index trÃªn key nÃ y.
Secondary Index cá»§a InnoDB sáº½ lÆ°u key cÃ¹ng vá»›i primary key á»Ÿ nÃºt lÃ¡. VÃ¬ váº­y náº¿u query cá»§a báº¡n hit secondary index thÃ¬ báº¡n sáº½ tá»‘n 2 láº§n Ä‘i trÃªn cÃ¢y B-Tree. Má»™t láº§n cho secondary index Ä‘á»ƒ tÃ¬m Ä‘Æ°á»£c primary key vÃ  láº§n 2 lÃ  láº¥y dá»¯ liá»‡u tá»« clustered index. NhÆ°ng náº¿u báº¡n select toÃ n cÃ¡c field trong 1 composite index thÃ¬ sáº½ chá»‰ tá»‘n 1 láº§n vÃ¬ cÃ¡c field Ä‘Ã³ Ä‘á»u Ä‘Ã£ Ä‘Æ°á»£c lÆ°u trong nÃºt lÃ¡ rá»“i, Ä‘Ã¢y gá»i lÃ  covering index.
Náº¿u báº¡n dÃ¹ng storage engine lÃ  InnoDB thÃ¬ máº·c Ä‘á»‹nh lÃ  sáº½ cÃ³ clustered index trÃªn primary key rá»“i. VÃ¬ váº­y náº¿u viá»‡c ghi thÃªm 1 hÃ ng diá»…n ra khÃ¡ nhiá»u thÃ¬ hÃ£y set primary key lÃ  sá»‘ vÃ  Ä‘á»ƒ AUTO_INCREMENT hoáº·c tá»± Ä‘áº£m báº£o lÃ  cÃ¡c key ghi vÃ o sáº½ cÃ³ thá»© tá»± tá»« Ä‘iá»ƒn tÄƒng dáº§n. CÃ¡ nhÃ¢n mÃ¬nh thÃ­ch cÃ¡ch Ä‘áº§u tiÃªn hÆ¡n vÃ¬ nÃ³ tÃ­ch kiá»‡m Ä‘Æ°á»£c ráº¥t nhiá»u cÃ´ng sá»©c, ta chá»‰ cáº§n ghi data, storage engine sáº½ lo háº¿t pháº§n cÃ²n láº¡i.</p>

<h2 id="káº¿t-luáº­n">Káº¿t Luáº­n</h2>

<p>Tá»•ng káº¿t láº¡i, thÃ¬ lá»£i Ã­ch cá»§a viá»‡c sá»­ dá»¥ng clustered index (hoáº·c vÃ´ tÃ¬nh xÃ i, náº¿u báº¡n Ä‘ang dÃ¹ng InnoDB cá»§a MySQL):</p>

<ul>
<li>Truy cáº­p data nhanh hÆ¡n vÃ¬ báº£n ghi cáº§n tÃ¬m Ä‘Æ°á»£c lÆ°u luÃ´n trong nÃºt lÃ¡.</li>
<li>Truy váº¥n sá»­ dá»¥ng covering index cÃ³ thá»ƒ tráº£ vá» luÃ´n cÃ¡c giÃ¡ trá»‹ lÆ°u á»Ÿ nÃºt lÃ¡.</li>
<li>CÃ¡c dá»¯ liá»‡u liÃªn quan Ä‘áº¿n nhau Ä‘Æ°á»£c lÆ°u thÃ nh cÃ¡c cá»¥m gáº§n nhau. VÃ­ du, khi phÃ¡t triá»ƒn má»™t á»©ng dá»¥ng nhÆ° google calender cháº³ng háº¡n, báº±ng viá»‡c set primary key tinh táº¿, báº¡n cÃ³ thá»ƒ truy váº¥n cÃ¡c sá»± kiá»‡n diá»…n ra trong 1 khu vá»±c chá»‰ báº±ng viá»‡c Ä‘á»c vÃ i page.</li>
</ul>

<p>Tuy nhiÃªn chÃºng ta cáº§n náº¯m Ä‘Æ°á»£c cÃ¡c Ä‘iá»ƒm báº¥t lá»£i cá»§a clustered index:</p>

<ul>
<li>Tá»‘c Ä‘á»™ ghi phá»¥ thuá»™c vÃ o thá»© tá»± ghi.</li>
<li>Update clustered index column sáº½ tá»‘n ráº¥t nhiá»u disk I/O vÃ¬ pháº£i di chuyá»ƒn hoÃ n toÃ n cÃ¡c báº£n ghi Ä‘Æ°á»£c update sang page khÃ¡c.</li>
<li>Viá»‡c update hoáº·c chÃ¨n thÃªm báº£n ghi má»›i vÃ o sáº½ gÃ¢y ra page split ráº¥t nhiá»u (pháº£i tÃ¡ch page Ä‘Ã£ Ä‘áº§y báº£n ghi thÃ nh 2 page khÃ¡c nhau Ä‘á»ƒ chÃ¨n thÃªm báº£n ghi má»›i). Page split sáº½ khiáº¿n khÃ´ng gian lÆ°u trá»¯ bá»‹ phÃ¬nh ra.</li>
<li>Truy váº¥n sá»­ dá»¥ng secondary index cÃ³ thá»ƒ cháº­m vÃ¬ pháº£i lookup index 2 láº§n.</li>
</ul>

<h2 id="tÃ i-liá»‡u-tham-kháº£o">TÃ i liá»‡u tham kháº£o</h2>

<ul>
<li><a href="https://dataintensive.net/">Designing Data-Intensive Applications</a></li>
<li><a href="https://www.highperfmysql.com/">High Performance MySQL</a></li>
</ul>

          </div>

          
          <div class="row">
            <div class="col-md-8">
            
            </div>
            
          </div>
          

          
          <div class="row pt-3">
            <div class="col-md-6">
              
            </div>
            
            <div class="col-md-6 text-right" >
              
            </div>
          </div>

          

        </div>
        

      </div>
      

      

    </div>
    


  </main>
  


    
    

<footer class="page-footer text-center font-small mt-4 wow fadeIn">


  
  <div class="pb-2 mt-5 pt-5">
    
      <a href="//github.com/vietdoan " target="_blank" rel="noopener"><i class="fab fa-github mr-3" aria-hidden="true"></i></a>    
    
    
      <a href="//linkedin.com/in/van-viet-doan-171017b5/" target="_blank" rel="noopener"><i class="fab fa-linkedin-in mr-3" aria-hidden="true"></i></a>
    

    
      <a href="//facebook.com/vietdoan.hp" target="_blank" rel="noopener"><i class="fab fa-facebook-f mr-3" aria-hidden="true"></i></a>
    

    

    

    

    


    
        <a href="mailto:vietdoanhp1996@email.com"><i class="far fa-envelope-open mr-3" aria-hidden="true"></i></a>
    

    

    

  </div>
  

  
  <div class="copyright py-4">
    
    <span>  2016 - 2019 &copy; | Theme <a href='https://github.com/orianna-zzo/AllinOne' target="_blank">AllinOne</a> by <a href='https://github.com/orianna-zzo' target="_blank">Orianna</a>  </span>
  </div>
  

</footer>


    






<script type="text/javascript" src="https://imvido.com/js/vendors/jquery/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="https://imvido.com/js/vendors/jquery/jquery.smooth-scroll.min.js"></script>



<script type="text/javascript" src="https://imvido.com/js/vendors/popper.min.js"></script>
<script type="text/javascript" src="https://imvido.com/js/vendors/holder.min.js"></script>
<script type="text/javascript" src="https://imvido.com/js/vendors-extensions/bootstrap4/bootstrap.js" ></script>

<script type="text/javascript" src="https://imvido.com/js/vendors/mdb/mdb.min.js"></script>

<script type="text/javascript" src="https://imvido.com/js/main.js"></script>



  
  <script src="https://imvido.com/js/vendors/highlight.pack.js"> </script>
  <script>hljs.initHighlightingOnLoad();</script>




 
  <script src="https://imvido.com/js/vendors/katex/katex.min.js"> </script>
  <script src="https://imvido.com/js/vendors/katex/contrib/auto-render.min.js"></script>

  <script>
      document.addEventListener("DOMContentLoaded", function () {
          renderMathInElement(document.body);
      });
  </script>








<script type="text/javascript">
  
  new WOW().init();
</script>




  </body>
</html>